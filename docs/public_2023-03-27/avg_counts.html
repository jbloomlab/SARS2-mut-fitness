<!DOCTYPE html>
<html>
 <head>
  <style>
   .error {
        color: red;
    }
   #vis {margin-left: 2.5%; margin-left: 2.5%; width: 95vw; overflow-x: auto;}
   #markdown {margin-left: 2.5%; margin-right: 2.5%; margin-top: 10px; }
   #vis input, #vis label, #vis span {font-size: 14px; margin: 0px 3px 1px 0px;}
  </style>
  <script src="https://cdn.jsdelivr.net/npm//vega@5" type="text/javascript">
  </script>
  <script src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0" type="text/javascript">
  </script>
  <script src="https://cdn.jsdelivr.net/npm//vega-embed@6" type="text/javascript">
  </script>
  <meta content="summary" name="twitter:card"/>
  <meta content="https://jbloomlab.github.io/SARS2-mut-fitness" name="twitter:site"/>
  <meta content="average per-site counts of each nucleotide mutation type" name="twitter:title"/>
  <meta content="average per-site counts of each nucleotide mutation type" name="twitter:description"/>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" rel="stylesheet"/>
 </head>
 <body>
  <div id="vis">
  </div>
  <script>
   (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "stroke": null}, "axis": {"grid": false}}, "data": {"name": "data-f3fc352f7a02a7cbdd2878d1c52f153b"}, "mark": "bar", "encoding": {"color": {"field": "mut_type", "legend": {"orient": "bottom", "titleOrient": "left"}, "scale": {"range": ["#999999", "#009E73", "#56B4E9", "#E69F00"]}, "sort": ["expected (4-fold degenerate)", "synonymous", "nonsynonymous", "stop"], "title": "type of count", "type": "nominal"}, "column": {"field": "mut", "header": {"labelAlign": "right", "labelAngle": -90, "labelBaseline": "middle", "labelOrient": "bottom", "labelPadding": 128}, "spacing": 0, "title": null, "type": "nominal"}, "opacity": {"condition": {"value": 1, "selection": "selector001"}, "value": 0.25}, "tooltip": [{"field": "mut_type", "title": "type of count", "type": "nominal"}, {"field": "mut", "title": "mutation type", "type": "nominal"}, {"field": "counts", "format": ".2f", "title": "average counts", "type": "quantitative"}], "x": {"axis": {"labels": false, "ticks": true, "values": ["synonymous"]}, "field": "mut_type", "scale": {"domain": ["dummy", "expected (4-fold degenerate)", "synonymous", "nonsynonymous", "stop"]}, "title": null, "type": "nominal"}, "y": {"field": "counts", "title": "average counts per site", "type": "quantitative"}}, "height": 120, "selection": {"selector001": {"type": "multi", "fields": ["mut_type"], "bind": "legend"}}, "width": 38, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-f3fc352f7a02a7cbdd2878d1c52f153b": [{"mut_type": "expected (4-fold degenerate)", "mut": "A to C", "counts": 8.778168715489551}, {"mut_type": "expected (4-fold degenerate)", "mut": "A to G", "counts": 70.82111536319401}, {"mut_type": "expected (4-fold degenerate)", "mut": "A to T", "counts": 19.71017014224341}, {"mut_type": "expected (4-fold degenerate)", "mut": "C to A", "counts": 37.37036890058017}, {"mut_type": "expected (4-fold degenerate)", "mut": "C to G", "counts": 11.84356964653058}, {"mut_type": "expected (4-fold degenerate)", "mut": "C to T", "counts": 552.4814602642937}, {"mut_type": "expected (4-fold degenerate)", "mut": "G to A", "counts": 152.55621500471895}, {"mut_type": "expected (4-fold degenerate)", "mut": "G to C", "counts": 17.697387065331235}, {"mut_type": "expected (4-fold degenerate)", "mut": "G to T", "counts": 323.35829204450914}, {"mut_type": "expected (4-fold degenerate)", "mut": "T to A", "counts": 13.543912519416962}, {"mut_type": "expected (4-fold degenerate)", "mut": "T to C", "counts": 64.14629234356646}, {"mut_type": "expected (4-fold degenerate)", "mut": "T to G", "counts": 8.4498085236218}, {"mut_type": "nonsynonymous", "mut": "A to C", "counts": 8.214814814814815}, {"mut_type": "nonsynonymous", "mut": "A to G", "counts": 43.78112840466926}, {"mut_type": "nonsynonymous", "mut": "A to T", "counts": 6.817348983681649}, {"mut_type": "nonsynonymous", "mut": "C to A", "counts": 20.418390287769785}, {"mut_type": "nonsynonymous", "mut": "C to G", "counts": 3.1065165620264126}, {"mut_type": "nonsynonymous", "mut": "C to T", "counts": 307.2237442922374}, {"mut_type": "nonsynonymous", "mut": "G to A", "counts": 58.95961538461538}, {"mut_type": "nonsynonymous", "mut": "G to C", "counts": 9.104510451045105}, {"mut_type": "nonsynonymous", "mut": "G to T", "counts": 90.5680633326897}, {"mut_type": "nonsynonymous", "mut": "T to A", "counts": 3.6601971190295677}, {"mut_type": "nonsynonymous", "mut": "T to C", "counts": 29.204726056043498}, {"mut_type": "nonsynonymous", "mut": "T to G", "counts": 5.269951718261858}, {"mut_type": "stop", "mut": "A to T", "counts": 1.7345360824742269}, {"mut_type": "stop", "mut": "C to A", "counts": 2.8438818565400843}, {"mut_type": "stop", "mut": "C to G", "counts": 1.1117021276595744}, {"mut_type": "stop", "mut": "C to T", "counts": 46.86854460093897}, {"mut_type": "stop", "mut": "G to A", "counts": 4.2362204724409445}, {"mut_type": "stop", "mut": "G to T", "counts": 29.934306569343065}, {"mut_type": "stop", "mut": "T to A", "counts": 0.8944223107569721}, {"mut_type": "stop", "mut": "T to G", "counts": 0.5784313725490197}, {"mut_type": "synonymous", "mut": "A to C", "counts": 9.243825205826472}, {"mut_type": "synonymous", "mut": "A to G", "counts": 66.39787902592302}, {"mut_type": "synonymous", "mut": "A to T", "counts": 18.077203204661327}, {"mut_type": "synonymous", "mut": "C to A", "counts": 35.30071942446043}, {"mut_type": "synonymous", "mut": "C to G", "counts": 11.779334500875656}, {"mut_type": "synonymous", "mut": "C to T", "counts": 594.8905775075988}, {"mut_type": "synonymous", "mut": "G to A", "counts": 112.22967032967033}, {"mut_type": "synonymous", "mut": "G to C", "counts": 17.176258992805757}, {"mut_type": "synonymous", "mut": "G to T", "counts": 319.8525179856115}, {"mut_type": "synonymous", "mut": "T to A", "counts": 13.749584026622296}, {"mut_type": "synonymous", "mut": "T to C", "counts": 73.57331030015115}, {"mut_type": "synonymous", "mut": "T to G", "counts": 8.0316426244765}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);
  </script>
  <div id="markdown">
   <hr/>
   <h2>
    average per-site counts of each nucleotide mutation type
   </h2>
   <p>
    Interactive plot of average counts per nucleotide site averaged over all clades and
sites. Counts are reported separately for the expected counts (estimated from
4-fold degenerate sites) and the counts for all synonymous mutations (including 4-fold
degenerate sites), nonsynonymous mutations, and stop mutations. Counts are stratified
by the type of nucleotide change in the mutation.
   </p>
   <p>
    You can mouseover points for details and click/shift-click the legend to highlight
specific types of counts.
   </p>
   <p>
    See
    <a href="https://www.biorxiv.org/content/10.1101/2023.01.30.526314v1">
     Bloom and Neher (2023)
    </a>
    for a paper describing the work.
   </p>
   <p>
    See
    <a href="https://github.com/jbloomlab/SARS2-mut-fitness">
     https://github.com/jbloomlab/SARS2-mut-fitness
    </a>
    for full computer code and data.
   </p>
   <p>
    See
    <a href="https://jbloomlab.github.io/SARS2-mut-fitness/">
     https://jbloomlab.github.io/SARS2-mut-fitness/
    </a>
    for links to all interactive plots.
   </p>
   <p>
    This plot is for the public_2023-03-27 dataset.
    <a href="index.html">
     Here
    </a>
    are all plots for that dataset.
   </p>
  </div>
 </body>
</html>
